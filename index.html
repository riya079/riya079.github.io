<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Excel sheet to Flashcards</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script defer src="app.js"></script>
    <meta name="color-scheme" content="light dark">
</head>
<body>
    <header class="app-header">
        <h1>Excel sheet to Flashcards</h1>
        <p class="subtitle">Study smarter with your Excel decks</p>
    </header>

    <main class="container">
        <section id="settingsPanel" class="card settings">
            <h2>Load a deck</h2>
            <div class="field-group">
                <div class="file-picker">
                    <button id="filePickerBtn" class="file-picker-btn">
                        <span class="file-icon">üìÅ</span>
                        <span class="file-text">Choose Excel File</span>
                        <span class="file-hint">Click to select .xlsx or .xls</span>
                    </button>
                    <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
                </div>
                <div id="selectedFile" class="hint"></div>
            </div>

            <div id="sheetsPanel" class="hidden">
                <div class="field-row">
                    <label for="sheetSelect">Worksheet</label>
                    <select id="sheetSelect"></select>
                </div>
                <div class="field-row">
                    <label for="questionCol">Question column</label>
                    <select id="questionCol"></select>
                </div>
                <div class="field-row">
                    <label>Answer columns</label>
                    <div class="answer-columns-container">
                        <div id="answerColsChecklist" class="checklist"></div>
                        <div class="hint">Check the columns you want as answers</div>
                    </div>
                </div>
                <div class="field-row">
                    <label for="startRow">Row range</label>
                    <div class="row-range">
                        <input id="startRow" type="number" min="2" value="2" aria-label="Start row">
                        <span>to</span>
                        <input id="endRow" type="number" min="2" value="2" aria-label="End row">
                    </div>
                </div>
                <div class="field-row">
                    <label for="shuffle">Shuffle</label>
                    <div class="toggle-container">
                        <input id="shuffle" type="checkbox" checked>
                        <label for="shuffle" class="toggle-slider"></label>
                    </div>
                </div>
                <div class="actions">
                    <button id="startBtn" class="primary">Start</button>
                </div>
            </div>
        </section>

        <section id="flashcardSection" class="card flashcard hidden" aria-live="polite">
            <div id="masteryStats" class="mastery-stats"></div>
            <div id="studyPrompt" class="study-prompt hint"></div>
            <div id="flashcard" class="flip-container" tabindex="0" role="button" aria-label="Flashcard">
                <div id="flipInner" class="flip-inner">
                    <div class="flip-face flip-front">
                        <div id="flashcardQuestion">Load a deck to begin</div>
                    </div>
                    <div class="flip-face flip-back">
                        <div id="flashcardAnswer"></div>
                    </div>
                </div>
            </div>
            <div class="confidence-rating hidden" id="confidenceRating">
                <div class="rating-prompt">How well did you know this?</div>
                <div class="rating-buttons">
                    <button class="confidence-btn hard" data-rating="hard">1 Hard üòÖ</button>
                    <button class="confidence-btn medium" data-rating="medium">2 Medium üòê</button>
                    <button class="confidence-btn easy" data-rating="easy">3 Easy üòä</button>
                </div>
            </div>
            <div class="controls">
                <button id="showAnswerBtn">Flip ‚ú®</button>
                <button id="restartBtn" class="secondary">Restart</button>
                <button id="settingsBtn" class="secondary">Settings</button>
            </div>
            <div class="kbd-hints hint" id="kbdHints">Space/Enter to flip</div>
        </section>

        <!-- Celebration Screen -->
        <section id="celebrationScreen" class="celebration hidden">
            <div class="celebration-content">
                <div class="celebration-title">üéâ Congratulations! üéâ</div>
                <div class="celebration-subtitle">You've mastered all <span id="totalCardsCount">0</span> cards!</div>
                <div class="celebration-stats">
                    <div class="stat-item">
                        <div class="stat-number" id="masteredCount">0</div>
                        <div class="stat-label">Cards Mastered</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="studyTime">0</div>
                        <div class="stat-label">Minutes Studied</div>
                    </div>
                </div>
                <div class="celebration-actions">
                    <button id="celebrateNewDeckBtn" class="primary">Load New Deck</button>
                </div>
            </div>
        </section>
    </main>


</body>
</html>


